# é¡¹ç›®çœŸå®éƒ¨ç½²æ¶æ„åˆ†ææŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: AI ADHD ç”Ÿäº§åŠ›å·¥å…·å¹³å°
**é¡¹ç›®ç±»å‹**: å…¨æ ˆåº”ç”¨ï¼ˆå‰ç«¯ + API ç½‘å…³ + MCP æœåŠ¡ï¼‰
**éƒ¨ç½²çŠ¶æ€**: å‰ç«¯å·²éƒ¨ç½²åˆ° Vercelï¼Œåç«¯æœåŠ¡å¾…éƒ¨ç½²

---

## ğŸ—ï¸ çœŸå®éƒ¨ç½²æ¶æ„

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·è®¿é—®å±‚                              â”‚
â”‚                  https://ai-adhd-web.vercel.app             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Vercel éƒ¨ç½²å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Next.js Web UI (Port 3000)               â”‚  â”‚
â”‚  â”‚  - ä¸ªäººç”Ÿäº§åŠ›æ´å¯Ÿé¡µé¢                                  â”‚  â”‚
â”‚  â”‚  - ç”¨æˆ·ç•Œé¢å’Œäº¤äº’                                      â”‚  â”‚
â”‚  â”‚  - å›¾è¡¨å±•ç¤º (Recharts)                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ API è°ƒç”¨
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Railway éƒ¨ç½²å±‚ (å¾…éƒ¨ç½²)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         API Server Gateway (Port 3003)                â”‚  â”‚
â”‚  â”‚  - Express.js æœåŠ¡å™¨                                   â”‚  â”‚
â”‚  â”‚  - CORS æ”¯æŒ                                           â”‚  â”‚
â”‚  â”‚  - MCP æœåŠ¡ä»£ç†                                        â”‚  â”‚
â”‚  â”‚  - å¥åº·æ£€æŸ¥ç«¯ç‚¹                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                      â”‚                              â”‚
â”‚        â”‚ ä»£ç†è¯·æ±‚             â”‚ ä»£ç†è¯·æ±‚                     â”‚
â”‚        â–¼                      â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ ChurnFlow    â”‚    â”‚ Shrimp Task Manager      â”‚          â”‚
â”‚  â”‚ MCP Service  â”‚    â”‚ MCP Service              â”‚          â”‚
â”‚  â”‚              â”‚    â”‚ (Port 3009)              â”‚          â”‚
â”‚  â”‚ - æ•°æ®åˆ†æ   â”‚    â”‚ - ä»»åŠ¡ç®¡ç†               â”‚          â”‚
â”‚  â”‚ - æ´å¯Ÿç”Ÿæˆ   â”‚    â”‚ - ä»»åŠ¡è§„åˆ’               â”‚          â”‚
â”‚  â”‚              â”‚    â”‚ - æ™ºèƒ½åˆ†æ               â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ ç»„ä»¶åˆ†è§£

### 1. Web UI (Next.js) - âœ… å·²éƒ¨ç½²åˆ° Vercel
**ä½ç½®**: `web-ui/`
**éƒ¨ç½²çŠ¶æ€**: âœ… ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­
**è®¿é—®åœ°å€**: https://ai-adhd-web.vercel.app

**æŠ€æœ¯æ ˆ**:
- Next.js 14
- TypeScript
- Tailwind CSS
- Recharts (å›¾è¡¨)
- Zustand (çŠ¶æ€ç®¡ç†)

**åŠŸèƒ½**:
- ä¸ªäººç”Ÿäº§åŠ›æ´å¯Ÿé¡µé¢
- æ•°æ®å¯è§†åŒ–
- ç”¨æˆ·ç•Œé¢å’Œäº¤äº’

**é…ç½®**:
```json
// vercel.json
{
  "version": 2,
  "name": "ai-adhd-web-ui",
  "builds": [
    {
      "src": "package.json",
      "use": "@vercel/next"
    }
  ],
  "routes": [
    {
      "src": "/api/(.*)",
      "dest": "/api/$1"
    },
    {
      "src": "/(.*)",
      "dest": "/$1"
    }
  ],
  "env": {
    "NEXT_PUBLIC_API_URL": "@api-url",
    "NEXT_PUBLIC_MCP_CHURNFLOW_URL": "@mcp-churnflow-url",
    "NEXT_PUBLIC_MCP_SHRIMP_URL": "@mcp-shrimp-url"
  }
}
```

---

### 2. API Server Gateway - â³ å¾…éƒ¨ç½²åˆ° Railway
**ä½ç½®**: `api-server/`
**éƒ¨ç½²çŠ¶æ€**: â³ å¾…éƒ¨ç½²
**ç«¯å£**: 3003

**æŠ€æœ¯æ ˆ**:
- Express.js
- CORS
- WebSocket æ”¯æŒ
- MCP SDK v1.25.1

**åŠŸèƒ½**:
- API ç½‘å…³å’Œè·¯ç”±
- MCP æœåŠ¡ä»£ç†
- å¥åº·æ£€æŸ¥ç«¯ç‚¹
- è¯·æ±‚è½¬å‘å’Œè´Ÿè½½å‡è¡¡

**å…³é”®ä»£ç **:
```javascript
// api-server/src/index.js
import StdioMCPClient from './stdio-mcp-client.js';

// å¥åº·æ£€æŸ¥ç«¯ç‚¹ - æ£€æŸ¥æ‰€æœ‰MCPæœåŠ¡çŠ¶æ€
app.get('/api/health', async (req, res) => {
  // æ£€æŸ¥ ChurnFlow MCP æœåŠ¡
  const churnFlowClient = new StdioMCPClient('../../churnflow-mcp');
  // æ£€æŸ¥ Shrimp MCP æœåŠ¡
  const shrimpClient = new StdioMCPClient('../../mcp-shrimp-task-manager');
});
```

**é…ç½®**:
```toml
# api-server/railway.toml
[build]
builder = "nixpacks"

[env]
NODE_ENV = "production"
PORT = "3003"

[run]
startCommand = "npm start"
```

---

### 3. ChurnFlow MCP Service - â³ å¾…éƒ¨ç½²
**ä½ç½®**: `churnflow-mcp/`
**éƒ¨ç½²çŠ¶æ€**: â³ å¾…éƒ¨ç½²

**åŠŸèƒ½**:
- æ•°æ®åˆ†æ
- ç”Ÿäº§åŠ›æ´å¯Ÿç”Ÿæˆ
- ç”¨æˆ·è¡Œä¸ºåˆ†æ

---

### 4. Shrimp Task Manager MCP Service - â³ å¾…éƒ¨ç½²
**ä½ç½®**: `mcp-shrimp-task-manager/`
**éƒ¨ç½²çŠ¶æ€**: â³ å¾…éƒ¨ç½²
**ç«¯å£**: 3009

**åŠŸèƒ½**:
- æ™ºèƒ½ä»»åŠ¡ç®¡ç†
- ä»»åŠ¡è§„åˆ’å’Œåˆ†è§£
- ä»»åŠ¡åˆ†æå’Œåæ€
- å·¥ä½œæµä¼˜åŒ–

**éƒ¨ç½²é…ç½®**:
```toml
# mcp-shrimp-task-manager/railway.toml
[build]
builder = "nixpacks"
buildCommand = "cd mcp-shrimp-task-manager && npm install && npm run build:mcp"

[env]
NODE_ENV = "production"
PORT = "3009"

[run]
startCommand = "cd mcp-shrimp-task-manager && npm run railway"
```

---

## ğŸ”„ çœŸå®éƒ¨ç½²æµç¨‹

### å½“å‰çŠ¶æ€
1. âœ… **Web UI**: å·²éƒ¨ç½²åˆ° Vercel
   - è®¿é—®: https://ai-adhd-web.vercel.app
   - çŠ¶æ€: è¿è¡Œæ­£å¸¸

2. â³ **åç«¯æœåŠ¡**: å¾…éƒ¨ç½²åˆ° Railway
   - API Server Gateway
   - ChurnFlow MCP Service
   - Shrimp Task Manager MCP Service

### å®Œæ•´éƒ¨ç½²æ­¥éª¤

#### é˜¶æ®µ 1: Railway åç«¯éƒ¨ç½²

1. **éƒ¨ç½² API Server Gateway**
   ```bash
   cd api-server
   # Railway ä¼šè‡ªåŠ¨æ£€æµ‹ railway.toml å¹¶éƒ¨ç½²
   ```

2. **éƒ¨ç½² ChurnFlow MCP Service**
   ```bash
   cd churnflow-mcp
   # é…ç½® Railway ç¯å¢ƒå˜é‡
   # éƒ¨ç½²æœåŠ¡
   ```

3. **éƒ¨ç½² Shrimp Task Manager MCP Service**
   ```bash
   cd mcp-shrimp-task-manager
   # Railway å·²é…ç½® railway.toml
   # éƒ¨ç½²æœåŠ¡
   ```

#### é˜¶æ®µ 2: ç¯å¢ƒå˜é‡é…ç½®

åœ¨ Vercel æ§åˆ¶å°é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡:

```bash
# API Server Gateway URL
NEXT_PUBLIC_API_URL=https://api-server-production.up.railway.app

# MCP æœåŠ¡ URL
NEXT_PUBLIC_MCP_CHURNFLOW_URL=https://churnflow-mcp-production.up.railway.app
NEXT_PUBLIC_MCP_SHRIMP_URL=https://shrimp-mcp-production.up.railway.app
```

#### é˜¶æ®µ 3: éªŒè¯éƒ¨ç½²

1. **å¥åº·æ£€æŸ¥**
   ```
   GET https://api-server-production.up.railway.app/api/health
   ```

2. **MCP æœåŠ¡æµ‹è¯•**
   ```
   POST https://api-server-production.up.railway.app/api/mcp/churnflow
   POST https://api-server-production.up.railway.app/api/mcp/shrimp
   ```

---

## ğŸŒ æœåŠ¡é€šä¿¡æµç¨‹

### ç”¨æˆ·è¯·æ±‚æµç¨‹
```
1. ç”¨æˆ·è®¿é—® Web UI
   â†“
2. Web UI è°ƒç”¨ API Gateway
   /api/health
   /api/mcp/churnflow
   /api/mcp/shrimp
   â†“
3. API Gateway ä»£ç†åˆ°å…·ä½“ MCP æœåŠ¡
   â†“
4. MCP æœåŠ¡å¤„ç†è¯·æ±‚å¹¶è¿”å›ç»“æœ
   â†“
5. API Gateway è¿”å›å“åº”ç»™ Web UI
   â†“
6. Web UI æ¸²æŸ“ç»“æœ
```

### API ç«¯ç‚¹ç»“æ„
```
API Server Gateway (Port 3003)
â”œâ”€â”€ /api/health                    # å¥åº·æ£€æŸ¥
â”œâ”€â”€ /api/mcp/churnflow            # ChurnFlow MCP ä»£ç†
â”‚   â”œâ”€â”€ POST /tools/list
â”‚   â”œâ”€â”€ POST /tools/call
â”‚   â””â”€â”€ POST /notifications
â””â”€â”€ /api/mcp/shrimp               # Shrimp MCP ä»£ç†
    â”œâ”€â”€ POST /tools/list
    â”œâ”€â”€ POST /tools/call
    â””â”€â”€ POST /notifications
```

---

## ğŸ“Š éƒ¨ç½²é…ç½®å¯¹æ¯”

| ç»„ä»¶ | ä½ç½® | éƒ¨ç½²å¹³å° | é…ç½®æ–‡ä»¶ | çŠ¶æ€ |
|------|------|----------|----------|------|
| Web UI | `web-ui/` | Vercel | `vercel.json` | âœ… å·²éƒ¨ç½² |
| API Gateway | `api-server/` | Railway | `railway.toml` | â³ å¾…éƒ¨ç½² |
| ChurnFlow MCP | `churnflow-mcp/` | Railway | å¾…åˆ›å»º | â³ å¾…éƒ¨ç½² |
| Shrimp MCP | `mcp-shrimp-task-manager/` | Railway | `railway.toml` | â³ å¾…éƒ¨ç½² |

---

## ğŸ¯ å…³é”®å‘ç°

### 1. æ¶æ„è®¾è®¡
- **ä¸‰å±‚æ¶æ„**: Web UI â†’ API Gateway â†’ MCP Services
- **å¾®æœåŠ¡æ¨¡å¼**: æ¯ä¸ª MCP æœåŠ¡ç‹¬ç«‹éƒ¨ç½²
- **API ç½‘å…³æ¨¡å¼**: ç»Ÿä¸€å…¥å£ï¼Œä»£ç†åˆ°å…·ä½“æœåŠ¡

### 2. éƒ¨ç½²ç­–ç•¥
- **å‰ç«¯**: Vercel (é€‚åˆé™æ€/Next.js åº”ç”¨)
- **åç«¯**: Railway (é€‚åˆ Node.js æœåŠ¡)
- **åˆ†ç¦»éƒ¨ç½²**: å‰åç«¯å®Œå…¨åˆ†ç¦»ï¼Œé€šè¿‡ API é€šä¿¡

### 3. æœåŠ¡å‘ç°
- API Gateway ä½¿ç”¨ç›¸å¯¹è·¯å¾„è®¿é—® MCP æœåŠ¡
- éœ€è¦ç¡®ä¿ Railway éƒ¨ç½²åæœåŠ¡é—´çš„ç½‘ç»œå¯è¾¾æ€§
- å¯èƒ½éœ€è¦ä½¿ç”¨ Railway çš„å†…éƒ¨ç½‘ç»œæˆ–ç¯å¢ƒå˜é‡é…ç½®

### 4. ç¯å¢ƒå˜é‡ä¾èµ–
```bash
# Web UI éœ€è¦çš„ç¯å¢ƒå˜é‡
NEXT_PUBLIC_API_URL              # API Gateway URL
NEXT_PUBLIC_MCP_CHURNFLOW_URL    # ChurnFlow MCP URL
NEXT_PUBLIC_MCP_SHRIMP_URL       # Shrimp MCP URL

# API Gateway éœ€è¦çš„ç¯å¢ƒå˜é‡
PORT=3003                        # æœåŠ¡ç«¯å£
NODE_ENV=production              # ç¯å¢ƒæ¨¡å¼

# MCP Services éœ€è¦çš„ç¯å¢ƒå˜é‡
PORT=3009                        # Shrimp MCP ç«¯å£
NODE_ENV=production              # ç¯å¢ƒæ¨¡å¼
```

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨é¡¹
1. **éƒ¨ç½² API Server Gateway åˆ° Railway**
   - åœ¨ Railway æ§åˆ¶å°åˆ›å»ºæ–°é¡¹ç›®
   - è¿æ¥ `api-server/` ç›®å½•
   - é…ç½®ç¯å¢ƒå˜é‡
   - è·å–éƒ¨ç½² URL

2. **éƒ¨ç½² MCP æœåŠ¡åˆ° Railway**
   - éƒ¨ç½² ChurnFlow MCP Service
   - éƒ¨ç½² Shrimp Task Manager MCP Service
   - è·å–å„æœåŠ¡ URL

3. **é…ç½® Vercel ç¯å¢ƒå˜é‡**
   - æ›´æ–° `NEXT_PUBLIC_API_URL`
   - æ›´æ–° `NEXT_PUBLIC_MCP_CHURNFLOW_URL`
   - æ›´æ–° `NEXT_PUBLIC_MCP_SHRIMP_URL`

4. **éªŒè¯ç«¯åˆ°ç«¯åŠŸèƒ½**
   - æµ‹è¯•å¥åº·æ£€æŸ¥ç«¯ç‚¹
   - æµ‹è¯• MCP å·¥å…·è°ƒç”¨
   - éªŒè¯å‰ç«¯åŠŸèƒ½

### æ½œåœ¨é—®é¢˜
1. **æœåŠ¡é—´é€šä¿¡**: ç¡®ä¿ Railway ä¸Šå„æœåŠ¡èƒ½ç›¸äº’é€šä¿¡
2. **CORS é…ç½®**: ç¡®ä¿ API Gateway æ­£ç¡®é…ç½® CORS
3. **ç¯å¢ƒå˜é‡**: ç¡®ä¿æ‰€æœ‰å¿…è¦çš„ç¯å¢ƒå˜é‡éƒ½å·²é…ç½®
4. **ç«¯å£é…ç½®**: ç¡®ä¿å„æœåŠ¡ä½¿ç”¨æ­£ç¡®çš„ç«¯å£

---

## ğŸ“ æ€»ç»“

### çœŸå®éƒ¨ç½²é€»è¾‘
1. **å‰ç«¯**: Next.js åº”ç”¨éƒ¨ç½²åœ¨ Vercel
2. **åç«¯**: Express API Gateway + MCP Services éƒ¨ç½²åœ¨ Railway
3. **é€šä¿¡**: å‰ç«¯é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®çš„åç«¯ URL è¿›è¡Œ API è°ƒç”¨
4. **æ¶æ„**: API Gateway ä»£ç†æ‰€æœ‰ MCP æœåŠ¡è¯·æ±‚

### å…³é”®é…ç½®
- **Vercel**: è´Ÿè´£ Web UI éƒ¨ç½²å’Œé™æ€èµ„æº
- **Railway**: è´Ÿè´£æ‰€æœ‰åç«¯æœåŠ¡ (API Gateway + MCP Services)
- **ç¯å¢ƒå˜é‡**: è¿æ¥å‰åç«¯çš„å…³é”®é…ç½®

### éƒ¨ç½²å°±ç»ªçŠ¶æ€
- âœ… Web UI: å·²éƒ¨ç½²å¹¶è¿è¡Œ
- â³ API Gateway: é…ç½®å®Œæˆï¼Œå¾…éƒ¨ç½²
- â³ MCP Services: é…ç½®å®Œæˆï¼Œå¾…éƒ¨ç½²
- â³ ç¯å¢ƒå˜é‡: å¾…é…ç½®

---

**åˆ†æå®Œæˆæ—¶é—´**: 2025å¹´12æœˆ28æ—¥
**åˆ†æè€…**: GitHub Copilot
**é¡¹ç›®çŠ¶æ€**: å‰ç«¯å·²éƒ¨ç½²ï¼Œåç«¯å¾…éƒ¨ç½²